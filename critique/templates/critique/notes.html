{% extends "critique/base.html" %}
{% load staticfiles %}
{% load l10n %}

{% block title %}notes{% endblock %}
{% block meta-description-page %}commentaires au sujet d'œuvres diverses{% endblock %}

{% block content %}

<ul id="media-bar" class="navbar subbar">
    <li><a desc="film" href={% url "list_notes" "film" %}>films</a></li>
    <li><a desc="serie" href={% url "list_notes" "serie" %}>séries</a></li>
    <li><a desc="album" href={% url "list_notes" "album" %}>musique</a></li>
    <li><a desc="jeu" href={% url "list_notes" "jeu" %}>jeux</a></li>
    <li><a desc="livre" href={% url "list_notes" "livre" %}>livres</a></li>
    <!-- <li><a href={% url "list_notes" "bd" %}>bd</a></li> -->
    <li><a desc="all" href={% url "list_notes" "all" %}>tout</a></li>
</ul>

<div id="notes_summaries">
{% for oeuvre in oeuvres %}
    <a href="{% url 'detail_oeuvre' oeuvre.slug %}" class="note_summary">
        <div class="oeuvre_display">
        {% if oeuvre.info.image_url %}
        <img src="{% static oeuvre.info.image_url %}" alt="{{ oeuvre.info.titles.vf }}" />
        {% endif %}
        </div>

        <div class="note_summary_text">
            <div class="info_text">
                <h2 class="title sub_title">{{ oeuvre.info.titles.vf }} ({{ oeuvre.info.year }})</h2>
            </div>

            {% with oeuvre.comments.0 as comment %}
            <article class="note_content_summary">
                <div class="comment_text">
                    {% for p in comment.content %}
                    {{ p|striptags }}
                    {% endfor %}
                </div>
                <p class="comment_date">
                    {% localize on %}
                    {% if comment.date_month_unknown %}
                        {{ comment.date|date:"Y" }}
                    {% elif comment.date_day_unknown %}
                        {{ comment.date|date:"F Y" }}
                    {% else %}
                        {% if comment.date|date:"j" == "1" %}
                            1er {{ comment.date|date:"F Y" }}
                        {% else %}
                            {{ comment.date|date:"j F Y" }}
                        {% endif %}
                    {% endif %}
                    {% endlocalize %}
                </p>
            </article>
            {% endwith %}
        </div>
    </a>
{% endfor %}
</div>


<div id="pagination">
    {% if oeuvres.has_previous %}
        <a href={% url "list_notes" mtype oeuvres.previous_page_number %}><-</a>
    {% endif %}

    <span class="current">
        page {{ oeuvres.number }} sur {{ oeuvres.paginator.num_pages }}
    </span>

    {% if oeuvres.has_next %}
    <a href={% url "list_notes" mtype oeuvres.next_page_number %}>-></a>
    {% endif %}
</div>
    
<script type="text/javascript">
    var previous_page_url = null;
    {% if oeuvres.has_previous %}
    previous_page_url = '{% url "list_notes" mtype oeuvres.previous_page_number %}';
    {% endif %}
    var next_page_url = null;
    {% if oeuvres.has_next %}
    next_page_url = '{% url "list_notes" mtype oeuvres.next_page_number %}';
    {% endif %}
</script>

{% endblock %}
